---
page_type: sample
languages:
  - php
  - perl
  - python
products:
  - azure
description: "This sample demonstrates three different applications that query the Azure Key Vault Rest API."
---

# Azure Key Vault API

This sample demonstrates three different applications that query the Azure Key Vault Rest API. (https://docs.microsoft.com/en-us/rest/api/keyvault/).

## Azure Key Vault Setup

The POC's in this repository require certain azure resources to be "scaffolded out" to operate.
A setup script file is provided, Setup-Azure.ps1 that will demonstrate how take care of this through Azure CLI.

These resources include:
* An existing Azure Subscription.
* A Resource Group to contain all of the resources.
* Key Vault to store secrets including a policy.
* Azure AD (which comes default with your subscription) to manage the Service Principal.
* A Service Principal which delegates access to the Key Vault.

Filling in your "SUBSCRIPTION_ID" and running Setup-Azure.ps1 will provide guided steps to scafolding out a basic Azure Keyvault instance.

## Azure Key Vault API

Most of the samples in this repository utilize the Azure Rest API to query the Key Vault.
The Azure Rest API requires a user to authorize via a Bearer token in the header of each request to the Key Vault.

The Bearer token is generated by POSTing to /oauth2/token with the Service Principal Id, Secret and a resource set to 'https://vault.azure.net'.

POST /{{tenantId}}/oauth2/token HTTP/1.1
Host: login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

grant_type=client_credentials&client_id={{clientId}}&client_secret={{clientSecret}}&resource=https://vault.azure.net

Once this bearer token is retrieved, a GET request can be made to /secrets/{{secretName}}/ to retrieve such secret in the form:

GET /secrets/{{secretName}}/?api-version={{apiVersion}} HTTP/1.1
Host: {{vaultUri}}
Authorization: Bearer {{bearerToken}}
Content-Type: application/json

## Contributing

This project has adopted the [Microsoft Open Source Code of Conduct](https://opensource.microsoft.com/codeofconduct/). For more information see the [Code of Conduct FAQ](https://opensource.microsoft.com/codeofconduct/faq/) or contact [opencode@microsoft.com](mailto:opencode@microsoft.com) with any additional questions or comments.
